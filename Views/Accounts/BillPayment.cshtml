@model IEnumerable<Payment>
    @{
        Layout = "~/Views/Shared/_Accounts_Layout.cshtml";
        var billId = ViewBag.BillId;
    }

    <style>
        /* Advanced CSS for Payment History */
        .payment-card {
            background: #ffffff;
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        .card-header-custom {
            background: linear-gradient(135deg, #1d976c 0%, #11998e 100%);
            padding: 25px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-container {
            padding: 20px;
        }

        .custom-table {
            margin-bottom: 0;
        }

            .custom-table thead th {
                background-color: #f8fafc;
                color: #64748b;
                font-weight: 600;
                text-transform: uppercase;
                font-size: 0.75rem;
                letter-spacing: 0.5px;
                border-top: none;
                padding: 15px;
            }

            .custom-table tbody td {
                padding: 15px;
                vertical-align: middle;
                color: #334155;
                border-bottom: 1px solid #f1f5f9;
            }

            .custom-table tbody tr:hover {
                background-color: #f0fff4;
                transition: 0.3s ease;
            }

        /* Status Badges */
        .badge-status {
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-completed {
            background: #dcfce7;
            color: #166534;
        }

        .status-pending {
            background: #fef9c3;
            color: #854d0e;
        }

        .method-icon {
            width: 32px;
            height: 32px;
            background: #f1f5f9;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            color: #1d976c;
        }

        .amount-text {
            font-weight: 700;
            color: #1d976c;
        }

        .btn-add-payment {
            background: #ffffff;
            color: #1d976c;
            border: none;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 10px;
            transition: 0.3s;
        }

            .btn-add-payment:hover {
                background: #f0fdf4;
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
    </style>

    <div class="container-fluid py-4">
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a asp-action="Dashboard" class="text-decoration-none">Home</a></li>
                <li class="breadcrumb-item"><a asp-action="BillView" class="text-decoration-none">Billing Center</a></li>
                <li class="breadcrumb-item active">Payment History</li>
            </ol>
        </nav>

        <div class="payment-card">
            <div class="card-header-custom">
                <div>
                    <h4 class="mb-1 fw-bold">🧾 Payment History</h4>
                    <p class="mb-0 opacity-75">Transactions for Bill ID: #@billId</p>
                </div>
                <a asp-action="PayPayement" asp-route-billId="@billId" class="btn btn-add-payment">
                    <i class="fa-solid fa-plus me-2"></i> Add New Payment
                </a>
            </div>

            <div class="table-container">
                <div class="table-responsive">
                    <table class="table custom-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Payment Method</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (!Model.Any())
                            {
                                <tr>
                                    <td colspan="5" class="text-center py-5 text-muted">
                                        <i class="fa-solid fa-folder-open d-block fs-2 mb-3"></i>
                                        No payments recorded yet.
                                    </td>
                                </tr>
                            }
                            @foreach (var p in Model)
                            {
                                <tr>
                                    <td>
                                        <div class="fw-bold">@p.PaymentDate.ToString("dd MMM, yyyy")</div>
                                        <small class="text-muted">@p.PaymentDate.ToShortTimeString()</small>
                                    </td>
                                    <td>
                                        <span class="method-icon">
                                            <i class="@(p.PaymentMethod == "Cash" ? "fa-solid fa-money-bill-1" : "fa-solid fa-building-columns")"></i>
                                        </span>
                                        @p.PaymentMethod
                                    </td>
                                    <td>
                                        <span class="amount-text">Rs. @p.PaidAmount.ToString("N2")</span>
                                    </td>
                                    <td>
                                        <span class="badge-status @(p.Status == "Completed" ? "status-completed" : "status-pending")">
                                            <i class="fa-solid fa-circle-check me-1"></i> @p.Status
                                        </span>
                                    </td>
                                    <td class="text-muted italic small">
                                        @(string.IsNullOrEmpty(p.Remarks) ? "---" : p.Remarks)
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="bg-light p-3 border-top d-flex justify-content-between">
                <a asp-controller="Accounts" asp-action="BillView" class="btn btn-outline-secondary btn-sm rounded-pill px-4">
                    <i class="fa-solid fa-arrow-left me-2"></i> Back to Bills
                </a>
                <div class="text-muted small">
                    Total Records: <strong>@Model.Count()</strong>
                </div>
            </div>
        </div>
    </div>
